const ethers = require("ethers");


const main = async () => {

	const provider = new ethers.providers.JsonRpcProvider('https://sepolia.infura.io/v3/13d34d3eca1445f5b7c1f3caefe8e47f');

	const ERC20_ABI = [
		{
			"inputs": [
				{
					"internalType": "address",
					"name": "patient",
					"type": "address"
				},
				{
					"internalType": "string",
					"name": "allergy",
					"type": "string"
				}
			],
			"name": "add_allergy",
			"outputs": [],
			"stateMutability": "nonpayable",
			"type": "function"
		},
		{
			"inputs": [
				{
					"internalType": "address",
					"name": "patient",
					"type": "address"
				},
				{
					"internalType": "string",
					"name": "chronicdisease",
					"type": "string"
				}
			],
			"name": "add_chronicdisease",
			"outputs": [],
			"stateMutability": "nonpayable",
			"type": "function"
		},
		{
			"inputs": [
				{
					"internalType": "address",
					"name": "patient",
					"type": "address"
				},
				{
					"internalType": "string",
					"name": "deficiency",
					"type": "string"
				}
			],
			"name": "add_deficiency",
			"outputs": [],
			"stateMutability": "nonpayable",
			"type": "function"
		},
		{
			"inputs": [
				{
					"internalType": "address",
					"name": "patient",
					"type": "address"
				},
				{
					"internalType": "string",
					"name": "CID",
					"type": "string"
				},
				{
					"internalType": "bytes32",
					"name": "timeStamp",
					"type": "bytes32"
				},
				{
					"internalType": "bytes32",
					"name": "category",
					"type": "bytes32"
				}
			],
			"name": "insertReport",
			"outputs": [],
			"stateMutability": "nonpayable",
			"type": "function"
		},
		{
			"inputs": [
				{
					"internalType": "address",
					"name": "patient",
					"type": "address"
				},
				{
					"internalType": "address",
					"name": "permitted",
					"type": "address"
				}
			],
			"name": "permitUpload",
			"outputs": [],
			"stateMutability": "nonpayable",
			"type": "function"
		},
		{
			"inputs": [
				{
					"internalType": "address",
					"name": "patient",
					"type": "address"
				},
				{
					"internalType": "address",
					"name": "permitted",
					"type": "address"
				}
			],
			"name": "permitView",
			"outputs": [],
			"stateMutability": "nonpayable",
			"type": "function"
		},
		{
			"inputs": [
				{
					"internalType": "address",
					"name": "patient",
					"type": "address"
				},
				{
					"internalType": "address",
					"name": "toRevoke",
					"type": "address"
				}
			],
			"name": "revokeUploadPermission",
			"outputs": [],
			"stateMutability": "nonpayable",
			"type": "function"
		},
		{
			"inputs": [
				{
					"internalType": "address",
					"name": "patient",
					"type": "address"
				},
				{
					"internalType": "address",
					"name": "toRevoke",
					"type": "address"
				}
			],
			"name": "revokeViewPermission",
			"outputs": [],
			"stateMutability": "nonpayable",
			"type": "function"
		},
		{
			"inputs": [
				{
					"internalType": "address",
					"name": "patient",
					"type": "address"
				},
				{
					"internalType": "uint8",
					"name": "_age",
					"type": "uint8"
				}
			],
			"name": "set_age",
			"outputs": [],
			"stateMutability": "nonpayable",
			"type": "function"
		},
		{
			"inputs": [
				{
					"internalType": "address",
					"name": "patient",
					"type": "address"
				},
				{
					"internalType": "bytes32",
					"name": "_Blood_Type",
					"type": "bytes32"
				}
			],
			"name": "set_blood_type",
			"outputs": [],
			"stateMutability": "nonpayable",
			"type": "function"
		},
		{
			"inputs": [
				{
					"internalType": "address",
					"name": "patient",
					"type": "address"
				},
				{
					"internalType": "uint40",
					"name": "_number",
					"type": "uint40"
				}
			],
			"name": "set_contactnumber",
			"outputs": [],
			"stateMutability": "nonpayable",
			"type": "function"
		},
		{
			"inputs": [
				{
					"internalType": "address",
					"name": "patient",
					"type": "address"
				},
				{
					"internalType": "bytes32",
					"name": "_gender",
					"type": "bytes32"
				}
			],
			"name": "set_gender",
			"outputs": [],
			"stateMutability": "nonpayable",
			"type": "function"
		},
		{
			"inputs": [
				{
					"internalType": "address",
					"name": "patient",
					"type": "address"
				},
				{
					"internalType": "string",
					"name": "_patient_Name",
					"type": "string"
				}
			],
			"name": "set_name",
			"outputs": [],
			"stateMutability": "nonpayable",
			"type": "function"
		},
		{
			"inputs": [
				{
					"internalType": "address",
					"name": "patient",
					"type": "address"
				}
			],
			"name": "get_age",
			"outputs": [
				{
					"internalType": "uint8",
					"name": "",
					"type": "uint8"
				}
			],
			"stateMutability": "view",
			"type": "function"
		},
		{
			"inputs": [
				{
					"internalType": "address",
					"name": "patient",
					"type": "address"
				}
			],
			"name": "get_Allergies",
			"outputs": [
				{
					"internalType": "string[]",
					"name": "",
					"type": "string[]"
				}
			],
			"stateMutability": "view",
			"type": "function"
		},
		{
			"inputs": [
				{
					"internalType": "address",
					"name": "patient",
					"type": "address"
				}
			],
			"name": "get_blood_group",
			"outputs": [
				{
					"internalType": "bytes32",
					"name": "",
					"type": "bytes32"
				}
			],
			"stateMutability": "view",
			"type": "function"
		},
		{
			"inputs": [
				{
					"internalType": "address",
					"name": "patient",
					"type": "address"
				}
			],
			"name": "get_ChronicDiseases",
			"outputs": [
				{
					"internalType": "string[]",
					"name": "",
					"type": "string[]"
				}
			],
			"stateMutability": "view",
			"type": "function"
		},
		{
			"inputs": [
				{
					"internalType": "address",
					"name": "patient",
					"type": "address"
				}
			],
			"name": "get_contactnumber",
			"outputs": [
				{
					"internalType": "uint40",
					"name": "",
					"type": "uint40"
				}
			],
			"stateMutability": "view",
			"type": "function"
		},
		{
			"inputs": [
				{
					"internalType": "address",
					"name": "patient",
					"type": "address"
				}
			],
			"name": "get_Deficiencies",
			"outputs": [
				{
					"internalType": "string[]",
					"name": "",
					"type": "string[]"
				}
			],
			"stateMutability": "view",
			"type": "function"
		},
		{
			"inputs": [
				{
					"internalType": "address",
					"name": "patient",
					"type": "address"
				}
			],
			"name": "get_gender",
			"outputs": [
				{
					"internalType": "bytes32",
					"name": "",
					"type": "bytes32"
				}
			],
			"stateMutability": "view",
			"type": "function"
		},
		{
			"inputs": [
				{
					"internalType": "address",
					"name": "patient",
					"type": "address"
				}
			],
			"name": "get_name",
			"outputs": [
				{
					"internalType": "string",
					"name": "",
					"type": "string"
				}
			],
			"stateMutability": "view",
			"type": "function"
		},
		{
			"inputs": [
				{
					"internalType": "address",
					"name": "patient",
					"type": "address"
				}
			],
			"name": "getReports",
			"outputs": [
				{
					"components": [
						{
							"internalType": "string",
							"name": "cID",
							"type": "string"
						},
						{
							"internalType": "bytes32",
							"name": "timeStamp",
							"type": "bytes32"
						},
						{
							"internalType": "bytes32",
							"name": "category",
							"type": "bytes32"
						}
					],
					"internalType": "struct demo.report[]",
					"name": "",
					"type": "tuple[]"
				}
			],
			"stateMutability": "view",
			"type": "function"
		},
		{
			"inputs": [
				{
					"internalType": "address",
					"name": "",
					"type": "address"
				}
			],
			"name": "map",
			"outputs": [
				{
					"internalType": "string",
					"name": "patientName",
					"type": "string"
				},
				{
					"internalType": "bytes32",
					"name": "gender",
					"type": "bytes32"
				},
				{
					"internalType": "uint8",
					"name": "age",
					"type": "uint8"
				},
				{
					"internalType": "uint40",
					"name": "contactNumber",
					"type": "uint40"
				},
				{
					"internalType": "bytes32",
					"name": "bloodType",
					"type": "bytes32"
				}
			],
			"stateMutability": "view",
			"type": "function"
		},
		{
			"inputs": [
				{
					"internalType": "address",
					"name": "",
					"type": "address"
				},
				{
					"internalType": "address",
					"name": "",
					"type": "address"
				}
			],
			"name": "uploadPermitted",
			"outputs": [
				{
					"internalType": "bool",
					"name": "",
					"type": "bool"
				}
			],
			"stateMutability": "view",
			"type": "function"
		},
		{
			"inputs": [
				{
					"internalType": "address",
					"name": "",
					"type": "address"
				},
				{
					"internalType": "address",
					"name": "",
					"type": "address"
				}
			],
			"name": "viewPermitted",
			"outputs": [
				{
					"internalType": "bool",
					"name": "",
					"type": "bool"
				}
			],
			"stateMutability": "view",
			"type": "function"
		}
	];

	const address = '0x693933f18c335dfa3a10c8c316d64addafae5725'
	const contract = new ethers.Contract(address, ERC20_ABI, provider)


	const signer = await contract.getSigner();
	const signerAddress = await signer.getAddress();
	const name = await contract.get_name(signerAddress);

	try { console.log(name); }
	catch (err) {
		console.log(err);
	}

}

// main ()
export default main;